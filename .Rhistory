library(dplyr)
library(forecast)
library(tseries)
library(ggplot2)
citron = read.csv("citron.csv", stringsAsFactors = FALSE) |>
mutate(DATE = as.Date(DATE),PRIX = as.numeric(PRIX))
head(citron)
abidjan = citron|> filter(VILLE == "ABIDJAN") |> arrange(DATE)
abidjan
bouake = citron |> filter(VILLE == "BOUAKE") |> arrange(DATE)
bouake
ts_abi = ts(abidjan$PRIX, frequency=12, start=c(2020,1))
ts_bou = ts(bouake$PRIX, frequency=12, start=c(2020,1))
ts_abi_diff = diff(ts_abi)
ts_bou_diff = diff(ts_bou)
adf.test(ts_abi)
adf.test(ts_bou)
kpss.test(ts_abi)
kpss.test(ts_bou)
ts_abi_diff = diff(ts_abi)
ts_bou_diff = diff(ts_bou)
ts_abi_diff = diff(ts_abi)
ts_bou_diff = diff(ts_bou)
adf.test(ts_abi_diff)
adf.test(ts_bou_diff)
kpss.test(ts_abi_diff)
kpss.test(ts_bou_diff)
ts_abi_diff = diff(ts_abi)
ts_bou_diff = diff(ts_bou)
adf.test(ts_abi_diff)
adf.test(ts_bou_diff)
kpss.test(ts_abi_diff)
kpss.test(ts_bou_diff)
ggseasonplot(ts_abi, year.labels = TRUE, year.labels.left = TRUE) +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
ggtitle("Saisonnalité des prix à Abidjan")
ggseasonplot(ts_bou, year.labels = TRUE, year.labels.left = TRUE) +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
ggtitle("Saisonnalité des prix à Bouaké")
acf1 = ggAcf(ts_abi, lag.max = 52, main = "ACF - Abidjan")
pacf1 = ggPacf(ts_abi, lag.max = 52, main = "PACF - Abidjan")
ggarrange(acf1, pacf1)
acf2 = ggAcf(ts_bou, lag.max = 52, main = "ACF - Bouaké")
pacf2 = ggPacf(ts_bou, lag.max = 52, main = "PACF - Bouaké")
ggarrange(acf2,pacf2)
# Installer le package ggpubr (si jamais fait)
install.packages("ggpubr")
# Charger la bibliothèque
library(ggpubr)
knitr::opts_chunk$set(echo = TRUE)
library(forecast)
library(tseries)
library(ggpubr)
acf1 = ggAcf(ts_abi, lag.max = 52, main = "ACF - Abidjan")
pacf1 = ggPacf(ts_abi, lag.max = 52, main = "PACF - Abidjan")
ggarrange(acf1, pacf1)
acf2 = ggAcf(ts_bou, lag.max = 52, main = "ACF - Bouaké")
pacf2 = ggPacf(ts_bou, lag.max = 52, main = "PACF - Bouaké")
ggarrange(acf2,pacf2)
library(ggpubr)
acf1 = ggAcf(ts_abi, lag.max = 20, main = "ACF - Abidjan pour $q$")
pacf1 = ggPacf(ts_abi, lag.max = 20, main = "PACF - Abidjan pour $P$")
ggarrange(acf1, pacf1)
acf2 = ggAcf(ts_bou, lag.max = 20, main = "ACF - Bouaké pour $q$")
pacf2 = ggPacf(ts_bou, lag.max = 20, main = "PACF - Bouaké pour $P$")
ggarrange(acf2,pacf2)
library(ggpubr)
acf1 = ggAcf(ts_abi, lag.max = 20, main = "ACF - Abidjan pour $q$")
pacf1 = ggPacf(ts_abi, lag.max = 20, main = "PACF - Abidjan pour $p$")
ggarrange(acf1, pacf1)
acf2 = ggAcf(ts_bou, lag.max = 20, main = "ACF - Bouaké pour $q$")
pacf2 = ggPacf(ts_bou, lag.max = 20, main = "PACF - Bouaké pour $p$")
ggarrange(acf2,pacf2)
library(ggpubr)
acf1 = ggAcf(ts_abi, lag.max = 104, main = "ACF - Abidjan pour $q$")
pacf1 = ggPacf(ts_abi, lag.max = 104, main = "PACF - Abidjan pour $p$")
ggarrange(acf1, pacf1)
acf2 = ggAcf(ts_bou, lag.max = 104, main = "ACF - Bouaké pour $q$")
pacf2 = ggPacf(ts_bou, lag.max = 104, main = "PACF - Bouaké pour $p$")
ggarrange(acf2,pacf2)
library(ggpubr)
acf1 = ggAcf(ts_abi, lag.max = 104, main = "ACF - Abidjan pour $Q$")
pacf1 = ggPacf(ts_abi, lag.max = 104, main = "PACF - Abidjan pour $P$")
ggarrange(acf1, pacf1)
acf2 = ggAcf(ts_bou, lag.max = 104, main = "ACF - Bouaké pour $Q$")
pacf2 = ggPacf(ts_bou, lag.max = 104, main = "PACF - Bouaké pour $P$")
ggarrange(acf2,pacf2)
ts_abi = ts(abidjan$PRIX, frequency=52, start=c(2020,1))
ts_bou = ts(bouake$PRIX, frequency=52, start=c(2020,1))
ggseasonplot(ts_abi, year.labels = TRUE, year.labels.left = TRUE) +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
ggtitle("Saisonnalité des prix à Abidjan")
ggseasonplot(ts_bou, year.labels = TRUE, year.labels.left = TRUE) +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
ggtitle("Saisonnalité des prix à Bouaké")
adf.test(ts_abi)
adf.test(ts_bou)
kpss.test(ts_abi)
kpss.test(ts_bou)
ts_abi_diff = diff(ts_abi)
ts_bou_diff = diff(ts_bou)
adf.test(ts_abi_diff)
adf.test(ts_bou_diff)
kpss.test(ts_abi_diff)
kpss.test(ts_bou_diff)
library(ggpubr)
acf1 = ggAcf(ts_abi, lag.max = 20, main = "ACF - Abidjan pour $q$")
pacf1 = ggPacf(ts_abi, lag.max = 20, main = "PACF - Abidjan pour $p$")
ggarrange(acf1, pacf1)
acf2 = ggAcf(ts_bou, lag.max = 20, main = "ACF - Bouaké pour $q$")
pacf2 = ggPacf(ts_bou, lag.max = 20, main = "PACF - Bouaké pour $p$")
ggarrange(acf2,pacf2)
library(ggpubr)
acf1 = ggAcf(ts_abi, lag.max = 104, main = "ACF - Abidjan pour $Q$")
pacf1 = ggPacf(ts_abi, lag.max = 104, main = "PACF - Abidjan pour $P$")
ggarrange(acf1, pacf1)
acf2 = ggAcf(ts_bou, lag.max = 104, main = "ACF - Bouaké pour $Q$")
pacf2 = ggPacf(ts_bou, lag.max = 104, main = "PACF - Bouaké pour $P$")
ggarrange(acf2,pacf2)
library(ggpubr)
acf1 = ggAcf(ts_abi, lag.max = 23, main = "ACF - Abidjan pour $q$")
pacf1 = ggPacf(ts_abi, lag.max = 23, main = "PACF - Abidjan pour $p$")
ggarrange(acf1, pacf1)
acf2 = ggAcf(ts_bou, lag.max = 23, main = "ACF - Bouaké pour $q$")
pacf2 = ggPacf(ts_bou, lag.max = 23, main = "PACF - Bouaké pour $p$")
ggarrange(acf2,pacf2)
library(ggpubr)
acf1 = ggAcf(ts_abi, lag.max = 20, main = "ACF - Abidjan pour $q$")
pacf1 = ggPacf(ts_abi, lag.max = 20, main = "PACF - Abidjan pour $p$")
ggarrange(acf1, pacf1)
acf2 = ggAcf(ts_bou, lag.max = 20, main = "ACF - Bouaké pour $q$")
pacf2 = ggPacf(ts_bou, lag.max = 20, main = "PACF - Bouaké pour $p$")
ggarrange(acf2,pacf2)
# Fonction générique pour séparer une série temporelle
split_ts <- function(ts_data, train_ratio = 0.8) {
split_point <- floor(length(ts_data) * train_ratio)
train <- window(ts_data, end = time(ts_data)[split_point])
test <- window(ts_data, start = time(ts_data)[split_point + 1])
return(list(train = train, test = test))
}
# Application à Abidjan
ts_abi_split <- split_ts(ts_abi)
train_abi <- ts_abi_split$train
test_abi <- ts_abi_split$test
# Application à Bouaké
ts_bou_split <- split_ts(ts_bou)
train_bou <- ts_bou_split$train
test_bou <- ts_bou_split$test
# Vérification
cat("Abidjan - Train:", length(train_abi), "semaines | Test:", length(test_abi), "semaines\n")
cat("Bouaké - Train:", length(train_bou), "semaines | Test:", length(test_bou), "semaines")
# Modèle ARIMA(1,1,0)
model_abi <- Arima(train_abi, order = c(1, 1, 0))
# Résumé et diagnostics
summary(model_abi)
checkresiduals(model_abi)  # Vérifie les résidus (bruit blanc)
# Modèle ARIMA(1,1,1)
model_bou <- Arima(train_bou, order = c(1, 1, 1))
# Résumé et diagnostics
summary(model_bou)
checkresiduals(model_bou)
# Modèle ARIMA(1,1,0)
model_abi <- Arima(train_abi, order = c(1, 1, 0))
summary(model_abi)
# Modèle ARIMA(1,1,1)
model_bou <- Arima(train_bou, order = c(1, 1, 1))
summary(model_bou)
checkresiduals(model_abi)
checkresiduals(model_bou)
# Modèle ARIMA(1,1,0)
model_abi <- Arima(train_abi, order = c(1, 1, 0))
# Afficher les métriques clés
cat("Abidjan - ARIMA(1,1,0) Performance:\n",
"AIC:", round(model_abi$aic, 2), "\n",
"BIC:", round(model_abi$bic, 2), "\n",
"RMSE:", round(accuracy(model_abi)[2], 2), "\n",
"MAE:", round(accuracy(model_abi)[3], 2), "\n",
"Log-Likelihood:", round(model_abi$loglik, 2))
# Modèle ARIMA(1,1,1)
model_bou <- Arima(train_bou, order = c(1, 1, 1))
cat("Bouaké - ARIMA(1,1,1) Performance:\n",
"AIC:", round(model_bou$aic, 2), "\n",
"BIC:", round(model_bou$bic, 2), "\n",
"RMSE:", round(accuracy(model_bou)[2], 2), "\n",
"MAE:", round(accuracy(model_bou)[3], 2), "\n",
"Log-Likelihood:", round(model_bou$loglik, 2))
# Modèle ARIMA(1,1,0)
model_abi <- Arima(train_abi, order = c(1, 1, 0))
# Afficher les métriques clés
cat("Abidjan - ARIMA(1,1,0) Performance:\n",
"AIC:", round(model_abi$aic, 2), "\n",
"BIC:", round(model_abi$bic, 2), "\n",
"RMSE:", round(accuracy(model_abi)[2], 2), "\n",
"MAE:", round(accuracy(model_abi)[3], 2), "\n",
"Log-Likelihood:", round(model_abi$loglik, 2))
# Modèle ARIMA(1,1,1)
model_bou <- Arima(train_bou, order = c(1, 1, 1))
cat("\n Bouaké - ARIMA(1,1,1) Performance:\n",
"AIC:", round(model_bou$aic, 2), "\n",
"BIC:", round(model_bou$bic, 2), "\n",
"RMSE:", round(accuracy(model_bou)[2], 2), "\n",
"MAE:", round(accuracy(model_bou)[3], 2), "\n",
"Log-Likelihood:", round(model_bou$loglik, 2))
# Modèle ARIMA(1,1,0)
model_abi <- Arima(train_abi, order = c(1, 1, 0))
# Afficher les métriques clés
cat("Abidjan - ARIMA(1,1,0) Performance:\n",
"AIC:", round(model_abi$aic, 2), "\n",
"BIC:", round(model_abi$bic, 2), "\n",
"RMSE:", round(accuracy(model_abi)[2], 2), "\n",
"MAE:", round(accuracy(model_abi)[3], 2), "\n",
"Log-Likelihood:", round(model_abi$loglik, 2))
# Modèle ARIMA(1,1,1)
model_bou <- Arima(train_bou, order = c(1, 1, 1))
cat("Bouaké - ARIMA(1,1,1) Performance:\n",
"AIC:", round(model_bou$aic, 2), "\n",
"BIC:", round(model_bou$bic, 2), "\n",
"RMSE:", round(accuracy(model_bou)[2], 2), "\n",
"MAE:", round(accuracy(model_bou)[3], 2), "\n",
"Log-Likelihood:", round(model_bou$loglik, 2))
# Modèle ARIMA(1,1,0)
model_abi <- Arima(train_abi, order = c(1, 1, 0))
# Afficher les métriques clés
cat("Abidjan - ARIMA(1,1,0) Performance:\n",
"AIC:", round(model_abi$aic, 2), "\n",
"BIC:", round(model_abi$bic, 2), "\n",
"RMSE:", round(accuracy(model_abi)[2], 2), "\n",
"MAE:", round(accuracy(model_abi)[3], 2), "\n",
"Log-Likelihood:", round(model_abi$loglik, 2))
# Modèle ARIMA(1,1,1)
model_bou <- Arima(train_bou, order = c(1, 1, 1))
cat("\n Bouaké - ARIMA(1,1,1) Performance:\n",
"AIC:", round(model_bou$aic, 2), "\n",
"BIC:", round(model_bou$bic, 2), "\n",
"RMSE:", round(accuracy(model_bou)[2], 2), "\n",
"MAE:", round(accuracy(model_bou)[3], 2), "\n",
"Log-Likelihood:", round(model_bou$loglik, 2))
# Modèle ARIMA(1,1,0)
model_abi <- Arima(train_abi, order = c(1, 1, 0))
# Afficher les métriques clés
cat("Abidjan - ARIMA(1,1,0) Performance:\n",
"AIC:", round(model_abi$aic, 2), "\n",
"BIC:", round(model_abi$bic, 2), "\n",
"RMSE:", round(accuracy(model_abi)[2], 2), "\n",
"MAE:", round(accuracy(model_abi)[3], 2), "\n",
"Log-Likelihood:", round(model_abi$loglik, 2))
# Modèle ARIMA(1,1,1)
model_bou <- Arima(train_bou, order = c(1, 1, 1))
cat("\n Bouaké - ARIMA(1,1,1) Performance:\n",
"AIC:", round(model_bou$aic, 2), "\n",
"BIC:", round(model_bou$bic, 2), "\n",
"RMSE:", round(accuracy(model_bou)[2], 2), "\n",
"MAE:", round(accuracy(model_bou)[3], 2), "\n",
"Log-Likelihood:", round(model_bou$loglik, 2))
# Créer un tableau comparatif
performance_table <- data.frame(
Ville = c("Abidjan", "Bouaké"),
Modèle = c("ARIMA(1,1,0)", "ARIMA(1,1,1)"),
AIC = c(model_abi$aic, model_bou$aic),
BIC = c(model_abi$bic, model_bou$bic),
RMSE = c(accuracy(model_abi)[2], accuracy(model_bou)[2]),
MAE = c(accuracy(model_abi)[3], accuracy(model_bou)[3])
)
print(performance_table)
# Modèle ARIMA(1,1,0)
model_abi <- Arima(train_abi, order = c(1, 1, 0))
# Modèle ARIMA(1,1,1)
model_bou <- Arima(train_bou, order = c(1, 1, 1))
# Modèle ARIMA(1,1,0)
model_abi <- Arima(train_abi, order = c(1, 1, 0))
# Modèle ARIMA(1,1,1)
model_bou <- Arima(train_bou, order = c(1, 1, 1))
# Créer un tableau comparatif
performance_table <- data.frame(
Ville = c("Abidjan", "Bouaké"),
Modèle = c("ARIMA(1,1,0)", "ARIMA(1,1,1)"),
AIC = c(model_abi$aic, model_bou$aic),
BIC = c(model_abi$bic, model_bou$bic),
RMSE = c(accuracy(model_abi)[2], accuracy(model_bou)[2]),
MAE = c(accuracy(model_abi)[3], accuracy(model_bou)[3])
)
print(performance_table)
# Modèle ARIMA(1,1,0)
model_abi <- Arima(train_abi, order = c(1, 1, 0))
# Modèle ARIMA(1,1,1)
model_bou <- Arima(train_bou, order = c(1, 1, 1))
# Créer un tableau comparatif
performance_table <- data.frame(
Ville = c("Abidjan", "Bouaké"),
Modèle = c("ARIMA(1,1,0)", "ARIMA(1,1,1)"),
AIC = c(model_abi$aic, model_bou$aic),
BIC = c(model_abi$bic, model_bou$bic),
RMSE = c(accuracy(model_abi)[2], accuracy(model_bou)[2]),
MAE = c(accuracy(model_abi)[3], accuracy(model_bou)[3])
)
print(performance_table)
checkresiduals(model_abi)
checkresiduals(model_bou)
library(forecast)
# Modèle SARIMA pour Abidjan : SARIMA(1,1,0)(1,1,0)[52]
model_sarima_abi <- Arima(train_abi, order = c(1, 1, 0), seasonal = list(order = c(1, 1, 0), period = 52))
# Modèle SARIMA pour Bouaké : SARIMA(1,1,1)(1,1,1)[52]
model_sarima_bou <- Arima(train_bou, order = c(1, 1, 1), seasonal = list(order = c(1, 1, 1), period = 52))
# Calcul des métriques de performance
performance_sarima <- data.frame(
Ville = c("Abidjan", "Bouaké"),
Modèle = c("SARIMA(1,1,0)(1,1,0)[52]", "SARIMA(1,1,1)(1,1,1)[52]"),
AIC = c(model_sarima_abi$aic, model_sarima_bou$aic),
BIC = c(model_sarima_abi$bic, model_sarima_bou$bic),
RMSE = c(accuracy(model_sarima_abi)[2], accuracy(model_sarima_bou)[2]),
MAE = c(accuracy(model_sarima_abi)[3], accuracy(model_sarima_bou)[3])
)
print(performance_sarima)
# Résidus pour SARIMA Abidjan
checkresiduals(model_sarima_abi)
# Résidus pour SARIMA Bouaké
checkresiduals(model_sarima_bou)
library(forecast)
# Modèle SARIMA pour Abidjan : SARIMA(1,1,0)(1,1,0)[52]
model_sarima_abi <- Arima(train_abi, order = c(1, 1, 0), seasonal = list(order = c(1, 1, 0), period = 52))
# Modèle SARIMA pour Bouaké : SARIMA(1,1,1)(1,1,1)[52]
model_sarima_bou <- Arima(train_bou, order = c(1, 1, 1), seasonal = list(order = c(1, 1, 1), period = 52))
# Calcul des métriques de performance
performance_sarima <- data.frame(
Ville = c("Abidjan", "Bouaké"),
Modèle = c("SARIMA(1,1,0)(1,1,0)[52]", "SARIMA(1,1,1)(1,1,1)[52]"),
AIC = c(model_sarima_abi$aic, model_sarima_bou$aic),
BIC = c(model_sarima_abi$bic, model_sarima_bou$bic),
RMSE = c(accuracy(model_sarima_abi)[2], accuracy(model_sarima_bou)[2]),
MAE = c(accuracy(model_sarima_abi)[3], accuracy(model_sarima_bou)[3])
)
print(performance_sarima)
# Résidus pour SARIMA Abidjan
checkresiduals(model_sarima_abi)
# Résidus pour SARIMA Bouaké
checkresiduals(model_sarima_bou)
library(forecast)
# Modèle SARIMA pour Abidjan : SARIMA(1,1,0)(1,1,0)[52]
model_sarima_abi <- Arima(train_abi, order = c(1, 1, 0), seasonal = list(order = c(1, 1, 0), period = 52))
# Modèle SARIMA pour Bouaké : SARIMA(1,1,1)(1,1,1)[52]
model_sarima_bou <- Arima(train_bou, order = c(1, 1, 1), seasonal = list(order = c(1, 1, 1), period = 52))
# Calcul des métriques de performance
performance_sarima <- data.frame(
Ville = c("Abidjan", "Bouaké"),
Modèle = c("SARIMA(1,1,0)(1,1,0)[52]", "SARIMA(1,1,1)(1,1,1)[52]"),
AIC = c(model_sarima_abi$aic, model_sarima_bou$aic),
BIC = c(model_sarima_abi$bic, model_sarima_bou$bic),
RMSE = c(accuracy(model_sarima_abi)[2], accuracy(model_sarima_bou)[2]),
MAE = c(accuracy(model_sarima_abi)[3], accuracy(model_sarima_bou)[3])
)
print(performance_sarima)
# Résidus pour SARIMA Abidjan
checkresiduals(model_sarima_abi)
# Résidus pour SARIMA Bouaké
checkresiduals(model_sarima_bou)
any(is.na(train_abi))
any(is.na(train_bou))
length(train_abi)
length(train_bou)
# Fonction générique pour séparer une série temporelle
split_ts <- function(ts_data, train_ratio = 0.9) {
split_point <- floor(length(ts_data) * train_ratio)
train <- window(ts_data, end = time(ts_data)[split_point])
test <- window(ts_data, start = time(ts_data)[split_point + 1])
return(list(train = train, test = test))
}
# Application à Abidjan
ts_abi_split <- split_ts(ts_abi)
train_abi <- ts_abi_split$train
test_abi <- ts_abi_split$test
# Application à Bouaké
ts_bou_split <- split_ts(ts_bou)
train_bou <- ts_bou_split$train
test_bou <- ts_bou_split$test
# Vérification
cat("Abidjan - Train:", length(train_abi), "semaines | Test:", length(test_abi), "semaines\n")
cat("Bouaké - Train:", length(train_bou), "semaines | Test:", length(test_bou), "semaines")
# Fonction générique pour séparer une série temporelle
split_ts <- function(ts_data, train_ratio = 0.8) {
split_point <- floor(length(ts_data) * train_ratio)
train <- window(ts_data, end = time(ts_data)[split_point])
test <- window(ts_data, start = time(ts_data)[split_point + 1])
return(list(train = train, test = test))
}
# Application à Abidjan
ts_abi_split <- split_ts(ts_abi)
train_abi <- ts_abi_split$train
test_abi <- ts_abi_split$test
# Application à Bouaké
ts_bou_split <- split_ts(ts_bou)
train_bou <- ts_bou_split$train
test_bou <- ts_bou_split$test
# Vérification
cat("Abidjan - Train:", length(train_abi), "semaines | Test:", length(test_abi), "semaines\n")
cat("Bouaké - Train:", length(train_bou), "semaines | Test:", length(test_bou), "semaines")
length(ts_abi)
length(ts_bou)
library(forecast)
# Modèle SARIMA pour Abidjan : SARIMA(1,1,0)(1,1,0)[52]
model_sarima_abi <- Arima(train_abi, order = c(1, 1, 0), seasonal = list(order = c(1, 1, 0), period = 4))
# Modèle SARIMA pour Bouaké : SARIMA(1,1,1)(1,1,1)[52]
model_sarima_bou <- Arima(train_bou, order = c(1, 1, 1), seasonal = list(order = c(1, 1, 1), period = 4))
# Calcul des métriques de performance
performance_sarima <- data.frame(
Ville = c("Abidjan", "Bouaké"),
Modèle = c("SARIMA(1,1,0)(1,1,0)[52]", "SARIMA(1,1,1)(1,1,1)[52]"),
AIC = c(model_sarima_abi$aic, model_sarima_bou$aic),
BIC = c(model_sarima_abi$bic, model_sarima_bou$bic),
RMSE = c(accuracy(model_sarima_abi)[2], accuracy(model_sarima_bou)[2]),
MAE = c(accuracy(model_sarima_abi)[3], accuracy(model_sarima_bou)[3])
)
print(performance_sarima)
# Résidus pour SARIMA Abidjan
checkresiduals(model_sarima_abi)
# Résidus pour SARIMA Bouaké
checkresiduals(model_sarima_bou)
